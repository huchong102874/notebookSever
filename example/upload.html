<!--
 * @Author: 夏2同学
 * @Date: 2020-07-15 22:06:32
 * @LastEditTime: 2020-07-18 13:17:27
 * @LastEditors: 夏2同学
 * @FilePath: \学习JavaScript\index.html
 * @Description: 
-->

<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <title></title>
    <script>
    </script>
</head>

<body>
    <div>
        选择文件(可多选):
        <input type="file" id="f1" multiple /><br /><br />
        <button type="button" id="btn-submit">上 传</button>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script>
        // axios.get('http://localhost:3000/a')
        //     .then(function (response) {
        //         // 处理成功情况
        //         console.log(response);
        //     })
        //     .catch(function (error) {
        //         // 处理错误情况
        //         console.log(error);
        //     })
        //     .finally(function () {
        //         // 总是会执行
        //     });

    </script>
    <script>
        function submitUpload() {
            //获得文件列表，注意这里不是数组，而是对象
            var fileList = document.getElementById('f1').files;

            var file = new FormData(); //构造FormData对象
            // file.append('title', document.getElementById('title').value);

            //多文件上传需要遍历添加到 fromdata 对象
            for (var i = 0; i < fileList.length; i++) {
                file.append('file', fileList[i]); //支持多文件上传
            }


            for (var value of file.values()) {
                console.log(value);
            }

            axios.post('http://localhost:3000/upload', file, {
                headers: {
                    'Content-Type': 'multipart/form-data'
                }
            })
                .then(function (response) {
                    // 处理成功情况
                    console.log(response);
                    
                })
                .catch(function (error) {
                    // 处理错误情况
                    console.log(error);
                })
                .finally(function () {
                    // 总是会执行
                });


        }

        //绑定提交事件
        document.getElementById('btn-submit').addEventListener('click', submitUpload);
    </script>
</body>

</html>